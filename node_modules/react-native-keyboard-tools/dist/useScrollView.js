import { useCallback, useRef } from "react";
import { findNodeHandle, NativeModules, } from "react-native";
const { ScrollViewManager } = NativeModules;
export const useKeyboardScrollView = () => {
    const keyboardAwareViewRef = useRef(null);
    const onContentSizeChange = useCallback(() => {
        if (ScrollViewManager && ScrollViewManager.getContentSize) {
            ScrollViewManager.getContentSize(findNodeHandle(keyboardAwareViewRef.current), (contentSize) => {
                if (keyboardAwareViewRef.current) {
                    keyboardAwareViewRef.current.contentSize = contentSize;
                }
            });
        }
    }, [keyboardAwareViewRef]);
    const onScrollViewLayout = useCallback((layoutEvent) => {
        const layout = layoutEvent?.nativeEvent?.layout;
        if (layout && keyboardAwareViewRef?.current) {
            keyboardAwareViewRef.current.layout = layout;
            keyboardAwareViewRef.current.contentOffset = { x: 0, y: 0 };
        }
        onContentSizeChange();
    }, [onContentSizeChange]);
    const onScrollViewScroll = useCallback((event) => {
        if (keyboardAwareViewRef.current) {
            const contentOffset = event?.nativeEvent?.contentOffset;
            keyboardAwareViewRef.current.contentOffset = contentOffset;
        }
        onContentSizeChange();
    }, [onContentSizeChange]);
    return {
        keyboardAwareViewRef,
        onScrollViewScroll,
        onScrollViewLayout,
        onContentSizeChange,
    };
};
